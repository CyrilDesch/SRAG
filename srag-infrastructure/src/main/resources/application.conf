srag {
  api {
    host = "0.0.0.0"
    host = ${?SRAG_API_HOST}
    port = 8080
    port = ${?SRAG_API_PORT}
    max-body-size-bytes = 104857600
    max-body-size-bytes = ${?SRAG_API_MAX_BODY_SIZE_BYTES}
  }

  migrations {
    run-on-startup = true
    run-on-startup = ${?MIGRATIONS_RUN_ON_STARTUP}
  }
  
  fixtures {
    load-on-startup = false
    load-on-startup = ${?FIXTURES_LOAD_ON_STARTUP}
  }

  jobs {
    max-attempts = 3
    max-attempts = ${?JOBS_MAX_ATTEMPTS}
    poll-interval-ms = 1000
    poll-interval-ms = ${?JOBS_POLL_INTERVAL_MS}
    batch-size = 5
    batch-size = ${?JOBS_BATCH_SIZE}
    initial-retry-delay-ms = 2000
    initial-retry-delay-ms = ${?JOBS_INITIAL_RETRY_DELAY_MS}
    max-retry-delay-ms = 60000
    max-retry-delay-ms = ${?JOBS_MAX_RETRY_DELAY_MS}
    backoff-factor = 2.0
    backoff-factor = ${?JOBS_BACKOFF_FACTOR}
    max-concurrent-jobs = 1
    max-concurrent-jobs = ${?JOBS_MAX_CONCURRENT_JOBS}
  }

  adapters {
    driven {
      database {
        type = "postgres"
        type = ${?DATABASE_TYPE}
        
        postgres {
          host = "localhost"
          host = ${?DATABASE_HOST}
          port = 5432
          port = ${?DATABASE_PORT}
          database = "srag"
          database = ${?DATABASE_NAME}
          user = "srag"
          user = ${?DATABASE_USER}
          password = "srag"
          password = ${?DATABASE_PASSWORD}
        }
      }
      
      vector-store {
        type = "qdrant"
        type = ${?VECTOR_STORE_TYPE}
        
        qdrant {
          url = "http://localhost:6333"
          url = ${?VECTOR_STORE_URL}
          api-key = ${?VECTOR_STORE_API_KEY}
          collection = "srag"
          collection = ${?VECTOR_STORE_COLLECTION}
        }
      }

      lexical-store {
        type = "opensearch"
        type = ${?LEXICAL_STORE_TYPE}

        opensearch {
          url = "http://localhost:9200"
          url = ${?LEXICAL_STORE_URL}
          index = "srag-chunks"
          index = ${?LEXICAL_STORE_INDEX}
          username = ${?LEXICAL_STORE_USERNAME}
          password = ${?LEXICAL_STORE_PASSWORD}
        }
      }
      
      transcriber {
        type = "assemblyai"
        type = ${?TRANSCRIBER_TYPE}
        
        whisper {
          model-path = "base"
          model-path = ${?TRANSCRIBER_MODEL}
          api-url = "http://localhost:9001"
          api-url = ${?TRANSCRIBER_URL}
        }
        
        assemblyai {
          api-url = "api.eu.assemblyai.com"
          api-url = ${?TRANSCRIBER_URL}
          api-key = ${?TRANSCRIBER_API_KEY}
        }
      }
      
      embedder {
        type = "huggingface"
        type = ${?EMBEDDER_TYPE}

        huggingface {
          model = "sentence-transformers/all-MiniLM-L6-v2"
          model = ${?EMBEDDER_MODEL}
          api-url = "http://localhost:8082"
          api-url = ${?EMBEDDER_URL}
        }
      }

      reranker {
        type = "transformers"
        type = ${?RERANKER_TYPE}

        transformers {
          model = "cross-encoder/ms-marco-MiniLM-L-6-v2"
          model = ${?RERANKER_MODEL}
          api-url = "http://localhost:8083"
          api-url = ${?RERANKER_URL}
        }
      }
      
      blob-store {
        type = "minio"
        type = ${?BLOB_STORE_TYPE}
        
        minio {
          host = "localhost"
          host = ${?BLOB_STORE_HOST}
          port = 9000
          port = ${?BLOB_STORE_PORT}
          access-key = "minioadmin"
          access-key = ${?BLOB_STORE_ACCESS_KEY}
          secret-key = "minioadmin"
          secret-key = ${?BLOB_STORE_SECRET_KEY}
          bucket = "srag-blobs"
          bucket = ${?BLOB_STORE_BUCKET}
        }
      }

      job-queue {
        type = "redis"
        type = ${?JOB_QUEUE_TYPE}

        redis {
          host = "localhost"
          host = ${?JOB_QUEUE_HOST}
          port = 6379
          port = ${?JOB_QUEUE_PORT}
          database = 0
          database = ${?JOB_QUEUE_DATABASE}
          password = ${?JOB_QUEUE_PASSWORD}
          queue-key = "srag:jobs:queue"
          queue-key = ${?JOB_QUEUE_KEY}
          dead-letter-key = "srag:jobs:dead"
          dead-letter-key = ${?JOB_QUEUE_DEAD_LETTER_KEY}
        }
      }
    }
    
    driving {
      api {
        type = "rest"
        type = ${?API_TYPE}
        
        rest {
          host = "0.0.0.0"
          host = ${?REST_API_HOST}
          port = 8080
          port = ${?REST_API_PORT}
          max-body-size-bytes = 104857600
          max-body-size-bytes = ${?REST_API_MAX_BODY_SIZE_BYTES}
        }
      }
    }
  }
}
